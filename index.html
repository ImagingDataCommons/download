<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>DuckDB-WASM S3 Multipart Parquet</title>
    <style>
        body { font-family: sans-serif; margin: 20px; }
        #output { margin-top: 10px; border: 1px solid #ccc; padding: 10px; white-space: pre-wrap; font-family: monospace; min-height: 50px; background-color: #f9f9f9; }
        #status { margin-bottom: 10px; font-weight: bold; }
        button { padding: 8px 15px; cursor: pointer; }
    </style>
</head>
<body>

    <h1>DuckDB-WASM: Query Multipart S3 Parquet Files</h1>
    <p>Attempting to query Parquet files using a recursive glob pattern from a public S3 bucket.</p>
    <div id="status">Initializing DuckDB-WASM...</div>
    <button id="queryButton" disabled>Run S3 Glob Query</button>
    <div id="output">Query results or errors will appear here.</div>

    <script src="https://cdn.jsdelivr.net/npm/@duckdb/duckdb-wasm@1.2.1/dist/duckdb-browser-sync.js"></script>

    <script>
    let db
    const LOGGER = new duckdb.ConsoleLogger();
    duckdb.createWorker(duckdb.getJsDelivrBundles(), LOGGER).then((DUCKDB) => {
        db = new duckdb.SyncDuckDB(LOGGER, DUCKDB);
        db.instantiate().then((arg) => {
            console.log(arg);
            db.connect().then((conn) => {
                conn.query(`SELECT 42 AS answer`).then( (result) => {
                    console.log(result.toArray()); // [{answer: 42}]        console.log(result.toArray()); // [{answer: 42}]
                });         
            });
        });
    });    

    </script>

</body>
</html>